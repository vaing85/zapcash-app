"use strict";(self.webpackChunkzappay=self.webpackChunkzappay||[]).push([[491],{9491:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var s=a(5043),r=a(12),l=a(4292),n=a(7904),i=a(2965),c=a(5041),o=a(2683),d=a(2704),x=a(8970),m=a(9422),h=a(6940),u=a(2145),y=a(579);const g=e=>{let{userEmail:t,amount:a,note:l}=e;const[i,c]=(0,s.useState)(""),[o,d]=(0,s.useState)(!1),[g,p]=(0,s.useState)(!0),b=(0,s.useCallback)(async()=>{try{p(!0);const e={type:"zappay_payment",recipient:t,amount:a||0,note:l||"",timestamp:(new Date).toISOString(),app:"ZapPay"},s=JSON.stringify(e),r=await x.toDataURL(s,{width:256,margin:2,color:{dark:"#1f2937",light:"#ffffff"}});c(r)}catch(e){console.error("Error generating QR code:",e),u.oR.error("Failed to generate QR code")}finally{p(!1)}},[t,a,l]);(0,s.useEffect)(()=>{b()},[b]);return(0,y.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-lg",children:[(0,y.jsxs)("div",{className:"text-center mb-6",children:[(0,y.jsx)(n.A,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),(0,y.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:a?"Request $".concat(a.toFixed(2)):"Receive Payment"}),(0,y.jsx)("p",{className:"text-gray-600",children:a?"Share this QR code to receive payment":"Share this QR code to receive any amount"}),l&&(0,y.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:['"',l,'"']})]}),(0,y.jsx)("div",{className:"flex justify-center mb-6",children:g?(0,y.jsx)("div",{className:"w-64 h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,y.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500"})}):(0,y.jsx)(r.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"bg-white p-4 rounded-lg shadow-inner",children:(0,y.jsx)("img",{src:i,alt:"Payment QR Code",className:"w-64 h-64"})})}),(0,y.jsxs)("div",{className:"space-y-3",children:[(0,y.jsx)("button",{onClick:async()=>{try{const e={type:"zappay_payment",recipient:t,amount:a||0,note:l||"",timestamp:(new Date).toISOString(),app:"ZapPay"};await navigator.clipboard.writeText(JSON.stringify(e)),d(!0),u.oR.success("Payment link copied to clipboard!"),setTimeout(()=>d(!1),2e3)}catch(e){u.oR.error("Failed to copy to clipboard")}},disabled:g,className:"w-full flex items-center justify-center space-x-2 bg-yellow-500 text-white py-3 px-4 rounded-lg font-medium hover:bg-yellow-600 disabled:opacity-50 transition-colors",children:o?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(m.A,{className:"w-5 h-5"}),(0,y.jsx)("span",{children:"Copied!"})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(h.A,{className:"w-5 h-5"}),(0,y.jsx)("span",{children:"Copy Payment Link"})]})}),(0,y.jsx)("button",{onClick:()=>{if(i){const e=document.createElement("a");e.download="zappay-payment-".concat(t,"-").concat(Date.now(),".png"),e.href=i,e.click()}},disabled:g||!i,className:"w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-200 disabled:opacity-50 transition-colors",children:"Download QR Code"})]}),(0,y.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:(0,y.jsxs)("p",{className:"text-sm text-yellow-800 text-center",children:["\ud83d\udca1 ",(0,y.jsx)("strong",{children:"Tip:"})," Others can scan this QR code with ZapPay to send you money instantly!"]})})]})};var p=a(6938),b=a(7591),w=a(4538),j=a(9399),f=a(7361),N=a.n(f);const v=e=>{let{isOpen:t,onClose:a,onScan:l,onError:i,className:c=""}=e;const o=(0,s.useRef)(null),d=(0,s.useRef)(null),x=(0,s.useRef)(null),[m,h]=(0,s.useState)(!1),[u,g]=(0,s.useState)(null),[f,v]=(0,s.useState)(null),k=(0,s.useCallback)((e,t)=>{const a=t.getContext("2d");if(!a)return;t.width=e.videoWidth,t.height=e.videoHeight,a.drawImage(e,0,0,t.width,t.height);const s=a.getImageData(0,0,t.width,t.height),r=N()(s.data,s.width,s.height);if(r){const e={data:r.data,format:"QR_CODE",timestamp:new Date};l(e),h(!1)}},[l]),C=(0,s.useCallback)(async()=>{try{g(null),v(null);const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}});x.current=e,v(!0),o.current&&(o.current.srcObject=e,o.current.play(),h(!0))}catch(e){const t=e instanceof Error?e.message:"Failed to access camera";g(t),v(!1),null===i||void 0===i||i(t)}},[i]),R=(0,s.useCallback)(()=>{x.current&&(x.current.getTracks().forEach(e=>e.stop()),x.current=null),h(!1)},[]);(0,s.useEffect)(()=>(t?C():R(),()=>{R()}),[t,C,R]),(0,s.useEffect)(()=>{if(!m||!o.current||!d.current)return;const e=setInterval(()=>{o.current&&d.current&&4===o.current.readyState&&k(o.current,d.current)},100);return()=>clearInterval(e)},[m,k]);const S=(0,s.useCallback)(()=>{R(),a()},[R,a]);return t?(0,y.jsx)(p.N,{children:(0,y.jsx)(r.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4 ".concat(c),children:(0,y.jsxs)(r.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(n.A,{className:"w-6 h-6 text-yellow-500"}),(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"QR Code Scanner"})]}),(0,y.jsx)("button",{onClick:S,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,y.jsx)(b.A,{className:"w-6 h-6"})})]}),(0,y.jsxs)("div",{className:"relative mb-4",children:[(0,y.jsxs)("div",{className:"relative bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden aspect-video",children:[(0,y.jsx)("video",{ref:o,className:"w-full h-full object-cover",playsInline:!0,muted:!0}),(0,y.jsx)("canvas",{ref:d,className:"hidden"}),m&&(0,y.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,y.jsxs)("div",{className:"w-48 h-48 border-2 border-yellow-500 rounded-lg relative",children:[(0,y.jsx)("div",{className:"absolute top-0 left-0 w-6 h-6 border-t-4 border-l-4 border-yellow-500 rounded-tl-lg"}),(0,y.jsx)("div",{className:"absolute top-0 right-0 w-6 h-6 border-t-4 border-r-4 border-yellow-500 rounded-tr-lg"}),(0,y.jsx)("div",{className:"absolute bottom-0 left-0 w-6 h-6 border-b-4 border-l-4 border-yellow-500 rounded-bl-lg"}),(0,y.jsx)("div",{className:"absolute bottom-0 right-0 w-6 h-6 border-b-4 border-r-4 border-yellow-500 rounded-br-lg"})]})})]}),(0,y.jsxs)("div",{className:"flex items-center justify-center space-x-4 mt-2",children:[null===f&&(0,y.jsxs)("div",{className:"flex items-center space-x-2 text-yellow-600 dark:text-yellow-400",children:[(0,y.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-yellow-500"}),(0,y.jsx)("span",{className:"text-sm",children:"Initializing camera..."})]}),!0===f&&m&&(0,y.jsxs)("div",{className:"flex items-center space-x-2 text-green-600 dark:text-green-400",children:[(0,y.jsx)(w.A,{className:"w-4 h-4"}),(0,y.jsx)("span",{className:"text-sm",children:"Scanning for QR codes..."})]}),!1===f&&(0,y.jsxs)("div",{className:"flex items-center space-x-2 text-red-600 dark:text-red-400",children:[(0,y.jsx)(j.A,{className:"w-4 h-4"}),(0,y.jsx)("span",{className:"text-sm",children:"Camera access denied"})]})]})]}),u&&(0,y.jsx)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200 rounded-lg",children:(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(j.A,{className:"w-4 h-4"}),(0,y.jsx)("span",{className:"text-sm",children:u})]})}),(0,y.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[(0,y.jsx)("p",{children:"\u2022 Point your camera at a QR code"}),(0,y.jsx)("p",{children:"\u2022 Make sure the QR code is well-lit and in focus"}),(0,y.jsx)("p",{children:"\u2022 The scanner will automatically detect and process the code"})]}),(0,y.jsxs)("div",{className:"flex space-x-2",children:[(0,y.jsx)("button",{onClick:S,className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Cancel"}),!1===f&&(0,y.jsx)("button",{onClick:C,className:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Try Again"})]})]})})}):null},k=()=>{const{user:e}=(0,l.A)(),[t,a]=(0,s.useState)("generate"),[x,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(""),[b,w]=(0,s.useState)("");return e?(0,y.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,y.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:[(0,y.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"QR Code Payments"}),(0,y.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Generate QR codes to receive payments or scan codes to send money"})]}),(0,y.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg mb-6",children:(0,y.jsxs)("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[(0,y.jsxs)("button",{onClick:()=>a("generate"),className:"flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-md font-medium transition-all ".concat("generate"===t?"bg-white dark:bg-gray-600 text-yellow-600 dark:text-yellow-400 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:[(0,y.jsx)(n.A,{className:"w-5 h-5"}),(0,y.jsx)("span",{children:"Generate QR"})]}),(0,y.jsxs)("button",{onClick:()=>a("scan"),className:"flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-md font-medium transition-all ".concat("scan"===t?"bg-white dark:bg-gray-600 text-yellow-600 dark:text-yellow-400 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:[(0,y.jsx)(i.A,{className:"w-5 h-5"}),(0,y.jsx)("span",{children:"Scan QR"})]})]})}),"generate"===t&&(0,y.jsxs)(r.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},className:"grid md:grid-cols-2 gap-6",children:[(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[(0,y.jsxs)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[(0,y.jsx)(c.A,{className:"w-6 h-6 text-yellow-500 mr-2"}),"Payment Request"]}),(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Amount (Optional)"}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(o.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,y.jsx)("input",{type:"number",step:"0.01",value:h,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"0.00"})]}),(0,y.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Leave empty to receive any amount"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Note (Optional)"}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(d.A,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,y.jsx)("textarea",{value:b,onChange:e=>w(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",rows:3,placeholder:"What's this payment for?"})]})]}),(0,y.jsx)("button",{onClick:()=>{h&&parseFloat(h)<=0&&u.oR.error("Amount must be greater than 0")},className:"w-full bg-yellow-500 text-white py-3 px-4 rounded-lg font-medium hover:bg-yellow-600 transition-colors",children:"Generate QR Code"})]})]}),(0,y.jsx)("div",{children:(0,y.jsx)(g,{userEmail:e.email,amount:h?parseFloat(h):void 0,note:b})})]}),"scan"===t&&(0,y.jsx)(r.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},className:"text-center",children:(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-12 shadow-lg",children:[(0,y.jsx)(i.A,{className:"w-20 h-20 text-gray-400 mx-auto mb-6"}),(0,y.jsx)("h3",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-4",children:"Scan QR Code"}),(0,y.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-8",children:"Click the button below to open the camera and scan a QR code"}),(0,y.jsx)("button",{onClick:()=>m(!0),className:"bg-yellow-500 text-white py-4 px-8 rounded-lg font-medium hover:bg-yellow-600 transition-colors text-lg",children:"Open Camera Scanner"})]})}),x&&(0,y.jsx)(v,{isOpen:x,onScan:e=>{console.log("Camera QR scan result:",e),u.oR.success("QR Code scanned: ".concat(e.data)),m(!1)},onClose:()=>m(!1)})]}):(0,y.jsx)("div",{children:"Please log in to use QR payments."})}}}]);
//# sourceMappingURL=491.10ffb994.chunk.js.map